{"ast":null,"code":"import _regeneratorRuntime from\"/home/niels/src/js/react/inputter/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/niels/src/js/react/inputter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/niels/src/js/react/inputter/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useRef}from'react';import'../App.css';import{TextField,ThemeProvider,createMuiTheme}from'@material-ui/core';import{green,orange}from'@material-ui/core/colors';import axios from'axios';import Lister from'../components/Lister';import fhirDepartment2 from'../../src/pix/fire2.png';import{ScaleLoader}from'react-spinners';import{Route,useLocation}from'react-router-dom';import Details from'../pages/Details';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LIMIT=52;var theme=createMuiTheme({palette:{primary:{main:orange[800]},secondary:{main:green[800]}}});var cancelTokenSource=axios.CancelToken.source();var queryId=Math.random().toString(20).substr(2);var Home=function Home(_){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),queryIdentifierValue=_useState2[0],setQueryIdentifierValue=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),queryKafkaOffset=_useState4[0],setQueryKafkaOffset=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),queryKafkaTopic=_useState6[0],setQueryKafkaTopic=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),queryIdentifierType=_useState8[0],setQueryIdentifierType=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];var img1=useRef();var img2=useRef();var location=useLocation();var onChangeIdentifierValue=function onChangeIdentifierValue(evt){setQueryIdentifierValue(evt.target.value);setError('');};var onChangeKafkaOffset=function onChangeKafkaOffset(evt){setQueryKafkaOffset(evt.target.value);setError('');};var onChangeKafkaTopic=function onChangeKafkaTopic(evt){setQueryKafkaTopic(evt.target.value);setError('');};var onChangeIdentifierType=function onChangeIdentifierType(evt){setQueryIdentifierType(evt.target.value);setError('');};useEffect(function(_){var timeout=setTimeout(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:localStorage.setItem('queryIdentifierValue',queryIdentifierValue?queryIdentifierValue:'');localStorage.setItem('queryKafkaOffset',queryKafkaOffset?queryKafkaOffset:'');localStorage.setItem('queryKafkaTopic',queryKafkaTopic?queryKafkaTopic:'');localStorage.setItem('queryIdentifierType',queryIdentifierType?queryIdentifierType:'');if(!(queryIdentifierValue||queryKafkaOffset||queryKafkaTopic||queryIdentifierType)){_context.next=18;break;}cancelTokenSource.cancel();_context.prev=6;setLoading(true);// await axios.post('https://api.fhirstation.net/api/v1/search/', {\n_context.next=10;return axios.post('https://api.fhirstation.net/function/seeker',{// await axios.post('http://192168.67.33:8080/function/seeker', {\ncancelToken:cancelTokenSource.token,search:{queryIdentifierValue:queryIdentifierValue,queryKafkaOffset:queryKafkaOffset,queryKafkaTopic:queryKafkaTopic,queryIdentifierType:queryIdentifierType},queryId:queryId},{// mode: 'no-cors'\n}).then(function(res){setData(res.data);setLoading(false);});case 10:_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](6);console.warn(_context.t0.message);setLoading(false);case 16:_context.next=20;break;case 18:setLoading(false);setData([]);case 20:case\"end\":return _context.stop();}}},_callee,null,[[6,12]]);}));return function(_x){return _ref.apply(this,arguments);};}(),500);if(!queryIdentifierValue&&!queryKafkaOffset&&!queryKafkaTopic&&!queryIdentifierType)setLoading(false);return function(_){return clearTimeout(timeout);};},[queryIdentifierValue,queryKafkaOffset,queryKafkaTopic,queryIdentifierType]);useEffect(function(_){setQueryIdentifierValue(localStorage.getItem('queryIdentifierValue'));setQueryKafkaOffset(localStorage.getItem('queryKafkaOffset'));setQueryKafkaTopic(localStorage.getItem('queryKafkaTopic'));setQueryIdentifierType(localStorage.getItem('queryIdentifierType'));},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Route,{path:\"/details/:topic/:offset\",component:Details}),location.pathname==='/'&&/*#__PURE__*/_jsx(\"header\",{className:\"App-header\",children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-flex',width:'90%',paddingBottom:'12px'},children:[/*#__PURE__*/_jsx(TextField,{style:{flex:'1',margin:10},margin:\"dense\",variant:\"standard\",onChange:onChangeKafkaTopic,value:queryKafkaTopic,color:\"primary\",type:\"search\",label:\"Search Kafka Topic\",placeholder:\"...\",spellCheck:false}),\" \",/*#__PURE__*/_jsx(TextField,{style:{flex:'1',margin:10},margin:\"dense\",variant:\"standard\",onChange:onChangeKafkaOffset,value:queryKafkaOffset,color:\"primary\",type:\"search\",label:\"Search Kafka Offset\",placeholder:\"...\",spellCheck:false}),\" \",/*#__PURE__*/_jsx(TextField,{style:{flex:'1',margin:10},margin:\"dense\",variant:\"standard\",onChange:onChangeIdentifierType,value:queryIdentifierType,color:\"primary\",type:\"search\",label:\"Search Identifier Type\",placeholder:\"...\",spellCheck:false}),\" \",/*#__PURE__*/_jsx(TextField,{style:{flex:'1',margin:10},margin:\"dense\",variant:\"standard\",onChange:onChangeIdentifierValue,value:queryIdentifierValue,color:\"primary\",type:\"search\",label:\"Search Identifier Value\",placeholder:\"...\",spellCheck:false}),\" \"]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-block',paddingTop:'20px',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"br\",{}),data.length>50?'50+':data.length,/*#__PURE__*/_jsx(\"br\",{}),\"row\",data.length===1?'':'s']}),/*#__PURE__*/_jsx(\"div\",{}),loading?/*#__PURE__*/_jsx(ScaleLoader,{color:\"orange\"}):data.length>0&&/*#__PURE__*/_jsx(Lister,{data:data,limit:LIMIT}),error&&/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'18px',color:'black'},children:error}),data.length===0&&!loading&&!error&&(queryIdentifierValue||queryKafkaOffset||queryKafkaTopic||queryIdentifierType)?/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'18px',color:'black'},children:\"No records found\"}):null,!queryIdentifierValue&&!queryKafkaOffset&&!queryKafkaTopic&&!queryIdentifierType&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{ref:img2,style:fire2Style,src:fhirDepartment2,alt:\"FHIR Station\"})})]})})})]});};var fire1Style={padding:0,margin:0,height:300,transition:'height 1s'};var fire2Style={padding:0,margin:0,height:250,opacity:1,transition:'opacity 1s'};export default Home;","map":{"version":3,"sources":["/home/niels/src/js/react/inputter/src/pages/Home.js"],"names":["useState","useEffect","useRef","TextField","ThemeProvider","createMuiTheme","green","orange","axios","Lister","fhirDepartment2","ScaleLoader","Route","useLocation","Details","LIMIT","theme","palette","primary","main","secondary","cancelTokenSource","CancelToken","source","queryId","Math","random","toString","substr","Home","_","queryIdentifierValue","setQueryIdentifierValue","queryKafkaOffset","setQueryKafkaOffset","queryKafkaTopic","setQueryKafkaTopic","queryIdentifierType","setQueryIdentifierType","data","setData","loading","setLoading","error","setError","img1","img2","location","onChangeIdentifierValue","evt","target","value","onChangeKafkaOffset","onChangeKafkaTopic","onChangeIdentifierType","timeout","setTimeout","localStorage","setItem","cancel","post","cancelToken","token","search","then","res","console","warn","message","clearTimeout","getItem","pathname","width","display","paddingBottom","flex","margin","length","paddingTop","fontSize","color","fire2Style","fire1Style","padding","height","transition","opacity"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport '../App.css'\nimport { TextField, ThemeProvider, createMuiTheme } from '@material-ui/core'\nimport { green, orange } from '@material-ui/core/colors'\nimport axios from 'axios'\nimport Lister from '../components/Lister'\nimport fhirDepartment2 from '../../src/pix/fire2.png'\nimport { ScaleLoader } from 'react-spinners'\nimport { Route, useLocation } from 'react-router-dom'\nimport Details from '../pages/Details'\n\nconst LIMIT = 52\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: orange[800],\n    },\n    secondary: {\n      main: green[800]\n    }\n  }\n})\n\nconst cancelTokenSource = axios.CancelToken.source()\n\nconst queryId = Math.random().toString(20).substr(2)\n\nconst Home = _ => {\n\n  const [queryIdentifierValue, setQueryIdentifierValue] = useState('')\n  const [queryKafkaOffset, setQueryKafkaOffset] = useState('')\n  const [queryKafkaTopic, setQueryKafkaTopic] = useState('')\n  const [queryIdentifierType, setQueryIdentifierType] = useState('')\n\n  const [data, setData] = useState([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n\n  const img1 = useRef()\n  const img2 = useRef()\n\n  const location = useLocation()\n\n  const onChangeIdentifierValue = evt => {\n    setQueryIdentifierValue(evt.target.value)\n    setError('')\n  }\n\n  const onChangeKafkaOffset = evt => {\n    setQueryKafkaOffset(evt.target.value)\n    setError('')\n  }\n\n  const onChangeKafkaTopic = evt => {\n    setQueryKafkaTopic(evt.target.value)\n    setError('')\n  }\n\n  const onChangeIdentifierType = evt => {\n    setQueryIdentifierType(evt.target.value)\n    setError('')\n  }\n\n  useEffect(_ => {\n    const timeout = setTimeout(async _ => {\n      localStorage.setItem('queryIdentifierValue', queryIdentifierValue ? queryIdentifierValue : '')\n      localStorage.setItem('queryKafkaOffset', queryKafkaOffset ? queryKafkaOffset : '')\n      localStorage.setItem('queryKafkaTopic', queryKafkaTopic ? queryKafkaTopic : '')\n      localStorage.setItem('queryIdentifierType', queryIdentifierType ? queryIdentifierType : '')\n      if (queryIdentifierValue || queryKafkaOffset || queryKafkaTopic || queryIdentifierType) {\n        cancelTokenSource.cancel()\n        try {\n          setLoading(true)\n            // await axios.post('https://api.fhirstation.net/api/v1/search/', {\n            await axios.post('https://api.fhirstation.net/function/seeker', {\n          // await axios.post('http://192168.67.33:8080/function/seeker', {\n            cancelToken: cancelTokenSource.token,\n            search: { queryIdentifierValue, queryKafkaOffset, queryKafkaTopic, queryIdentifierType },\n            queryId\n          }, {\n            // mode: 'no-cors'\n          })\n          .then(res => {\n            setData(res.data)\n            setLoading(false)\n          })\n        } catch(err) {\n          console.warn(err.message)\n          setLoading(false)\n        }\n      } else {\n        setLoading(false)\n        setData([])\n      }\n    }, 500)\n    if (!queryIdentifierValue && !queryKafkaOffset && !queryKafkaTopic && !queryIdentifierType)\n      setLoading(false)\n    return _ => clearTimeout(timeout)\n  }, [queryIdentifierValue, queryKafkaOffset, queryKafkaTopic, queryIdentifierType])\n  \n  useEffect(_ => {\n    setQueryIdentifierValue(localStorage.getItem('queryIdentifierValue'))\n    setQueryKafkaOffset(localStorage.getItem('queryKafkaOffset'))\n    setQueryKafkaTopic(localStorage.getItem('queryKafkaTopic'))\n    setQueryIdentifierType(localStorage.getItem('queryIdentifierType'))\n  }, [])\n\n  return (\n    <div className=\"App\">\n      <Route path=\"/details/:topic/:offset\" component={Details} />\n      {location.pathname === '/' &&\n      <header className=\"App-header\">\n        <ThemeProvider theme={theme}>\n          <div style={{ width: '100%' }}>\n            <div style={{ display: 'inline-flex', width: '90%', paddingBottom: '12px' }}>\n              <TextField\n                style={{ flex: '1', margin: 10 }}\n                margin='dense'\n                variant='standard'\n                onChange={onChangeKafkaTopic}\n                value={queryKafkaTopic}\n                color='primary'\n                type='search'\n                label='Search Kafka Topic'\n                placeholder='...'\n                spellCheck={false}\n                /> {/* text color in App.css: input */}\n              <TextField\n                style={{ flex: '1', margin: 10 }}\n                margin='dense'\n                variant='standard'\n                onChange={onChangeKafkaOffset}\n                value={queryKafkaOffset}\n                color='primary'\n                type='search'\n                label='Search Kafka Offset'\n                placeholder='...'\n                spellCheck={false}\n              /> {/* text color in App.css: input */}\n              <TextField\n                style={{ flex: '1', margin: 10 }}\n                margin='dense'\n                variant='standard'\n                onChange={onChangeIdentifierType}\n                value={queryIdentifierType}\n                color='primary'\n                type='search'\n                label='Search Identifier Type'\n                placeholder='...'\n                spellCheck={false}\n                /> {/* text color in App.css: input */}\n              <TextField\n                style={{ flex: '1', margin: 10 }}\n                margin='dense'\n                variant='standard'\n                onChange={onChangeIdentifierValue}\n                value={queryIdentifierValue}\n                color='primary'\n                type='search'\n                label='Search Identifier Value'\n                placeholder='...'\n                spellCheck={false}\n                /> {/* text color in App.css: input */}\n            </div>\n            {data.length > 0 && <div style={{ display: 'inline-block', paddingTop: '20px', fontSize: '14px' }}>\n              <br />{data.length > 50 ? '50+' : data.length}<br />row{data.length === 1 ? '' : 's'}\n            </div>}\n            <div></div>\n            {loading ? <ScaleLoader color='orange'/> : (data.length > 0 && <Lister data={data} limit={LIMIT} />)}\n            {error && <p style={{ fontSize: '18px', color: 'black' }}>{error}</p>}\n            {data.length === 0 && !loading && !error && (queryIdentifierValue || queryKafkaOffset || queryKafkaTopic || queryIdentifierType) ? <p style={{ fontSize: '18px', color: 'black' }}>No records found</p> : null}\n            {(!queryIdentifierValue && !queryKafkaOffset && !queryKafkaTopic && !queryIdentifierType) && <div><img ref={img2} style={fire2Style} src={fhirDepartment2} alt='FHIR Station' /></div>}\n          </div>\n        </ThemeProvider>\n      </header>}\n    </div>\n  )\n\n}\n\nconst fire1Style = {\n  padding: 0, margin: 0,\n  height: 300,\n  transition: 'height 1s'\n}\n\nconst fire2Style = {\n  padding: 0, margin: 0,\n  height: 250,\n  opacity: 1,\n  transition: 'opacity 1s'\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}